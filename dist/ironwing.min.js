/**
 ** ironwing - Ironwing is a lightweight front-end data library for model like data representations
 ** @author Andrei Cacio
 ** @version v0.3.1
 **/
function IW(t,e,n){"use strict";this.init(t,e,n)}"object"==typeof module?module.exports=IW:"function"==typeof define&&define.amd&&define(function(){"use strict";return IW}),function(){"use strict";var t=[];IW.prototype.init=function(e,n,r){var i=this,a=[];if(this.address=n?e+"/"+n:e,this.type=e,void 0===IW.adapter)throw"No adapter found";if(this._getAPIWithoutSerializer=function(){return IW.adapter.getAPIURL()+this.type+"/"+this.attr.id},r?(this.attr=r,this.attr.id||(this.attr.id=n)):IW.adapter.onDone(function(t){t.length?t.forEach(function(t){a.push(new IW(e,t.id,t))}):i.attr=t}).onFail(function(){throw"\nGET HTTP request failed for the resource: ["+i.type+"]. \n"}).ajax("get",this.address,!1),a.length)return a;var o=IW.find(this.type,this.attr.id);return o?o.attr=this.attr:t.push(this),1},IW.useAdapter=function(t,e){var n;IW.adapters&&IW.adapters.hasOwnProperty(t)&&(n=IW.adapters[t],n.init.apply(n,e),IW.adapter=n)},IW.prototype.update=function(e){var n=this,r=this.type,i=this._adapter;IW.adapter.onDone(function(e){t.forEach(function(t){t.type===r&&t._adapter===i&&(t.attr=e)})}).onFail(function(){throw"A problem has accoured while trying to update the ["+r+"] model"}).ajax("put",this.address,!1,n.attr),e&&e()},IW.prototype.get=function(t){var e=this;IW.adapter.onDone(function(t){e.attr=t}).ajax("get",this.address,!1),t&&t()},IW.prototype["delete"]=function(e){var n=this;IW.adapter("delete",this._getAPIWithoutSerializer(),!1),e&&e(),t=t.filter(function(t){return t.attr.id!==n.attr.id}),this.attr={}},IW.create=function(t,e){var n;if(IW.adapter.onDone(function(t){n=t}).ajax("post",t,!1,{attr:e}),!n)throw"A problem has accoured while trying to create a ["+this.type+"] model";return new this(t,n.id,n)},IW.find=function(e,n){var r;return t.forEach(function(t){t.type===e&&t.attr.id===n&&(r=t)}),r},IW.findAll=function(e){return t.filter(function(t){return t.type===e})}}(),function(t){"use strict";function e(){this.xhr=new XMLHttpRequest,this.appUrl=null,this.done=null,this.fail=null}function n(t){return"string"!=typeof t?"/":("/"!==t[t.length-1]&&(t+="/"),"/"!==t[0]&&(t="/"+t),t)}e.prototype.init=function(t){var e=this;this.apiUrl=n(t),this.done=null,this.fail=null,this.xhr.onreadystatechange=function(){var t;4===e.xhr.readyState&&200===e.xhr.status&&"function"==typeof e.done?(t=JSON.parse(e.xhr.responseText),e.done.call(null,t)):4===e.xhr.readyState&&404===e.xhr.status&&"function"==typeof e.fail&&e.fail.call(null)}},e.prototype.getAPIURL=function(){return this.apiUrl},e.prototype.onDone=function(t){return this.done=t,this},e.prototype.onFail=function(t){return this.fail=t,this},e.prototype.ajax=function(t,e,n,r){t=t.toUpperCase(),this.xhr.open(t,this.apiUrl+e,n),"POST"===t||"PUT"===t?(this.xhr.setRequestHeader("Content-Type","application/json;charset=UTF-8"),this.xhr.send(JSON.stringify(r))):this.xhr.send()},t.adapters=t.adapters||{},t.adapters.JSON=new e}(IW);