/*! Mjs 0.1 10-11-2014 */
function M(a,b,c){"use strict";this.init(a,b,c)}"object"==typeof module?module.exports=M:"function"==typeof define&&define.amd&&define(function(){"use strict";return M}),function(){"use strict";var a=[],b="/";M.setAPIAddress=function(a){b="/"!==a[a.length]?a+"/":a,console.info(b)},M.prototype.init=function(b,c,d){var e=this,f=[];if(this._adapter=c?"/api/"+b+"/"+c+".json":"/api/"+b+".json",this.type=b,this._getAdapterWithoutSerializer=function(){return"/api/"+this.type+"/"+this.attr.id},void 0===M.adapter)throw"No adapter found";if(d?(this.attr=d,this.attr.id||(this.attr.id=c)):M.adapter.onDone(function(a){a.length?a.forEach(function(a){f.push(new M(b,a.id,a))}):e.attr=a}).onFail(function(){throw"\nGET HTTP request failed for the resource: ["+e.type+"]. \n"}).ajax("get",this._adapter,!1),f.length)return f;var g=M.find(this.type,this.attr.id);return g?g.attr=this.attr:a.push(this),1},M.prototype.update=function(b){var c=this,d=this.type,e=this._adapter;M.adapter.onDone(function(b){a.forEach(function(a){a.type===d&&a._adapter===e&&(a.attr=b)})}).onFail(function(){throw"A problem has accoured while trying to update the ["+d+"] model"}).ajax("put",this._getAdapterWithoutSerializer(),!1,{attr:c.attr}),b&&b()},M.prototype.get=function(a){var b=this;M.adapter.onDone(function(a){b.attr=a}).ajax("get",b._adapter,!1),a&&a()},M.prototype.delete=function(b){var c=this;M.adapter("delete",this._getAdapterWithoutSerializer(),!1),b&&b(),a=a.filter(function(a){return a.attr.id!==c.attr.id}),this.attr={}},M.create=function(a,b){var c;if(M.adapter.onDone(function(a){c=a}).ajax("post","/api/"+a+".json",!1,{attr:b}),!c)throw"A problem has accoured while trying to create a ["+this.type+"] model";return new this(a,c.id,c)},M.find=function(b,c){var d;return a.forEach(function(a){a.type===b&&a.attr.id===c&&(d=a)}),d},M.findAll=function(b){return a.filter(function(a){return a.type===b})}}(),function(a){"use strict";function b(){var a=this;this.xhr=new XMLHttpRequest,this.done=null,this.fail=null,this.xhr.onreadystatechange=function(){var b;4===a.xhr.readyState&&200===a.xhr.status&&"function"==typeof a.done?(b=JSON.parse(a.xhr.responseText),a.done.call(null,b)):4===a.xhr.readyState&&404===a.xhr.status&&"function"==typeof a.fail&&a.fail.call(null)}}b.prototype.onDone=function(a){return this.done=a,this},b.prototype.onFail=function(a){return this.fail=a,this},b.prototype.ajax=function(a,b,c,d){a=a.toUpperCase(),this.xhr.open(a,b,c),"POST"===a||"PUT"===a?(this.xhr.setRequestHeader("Content-Type","application/json;charset=UTF-8"),this.xhr.send(JSON.stringify(d))):this.xhr.send()},a.adapter=new b}(M);